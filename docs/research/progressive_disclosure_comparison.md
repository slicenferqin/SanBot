# æ¸è¿›å¼æŠ«éœ² vs ä¼ ç»Ÿæ–¹æ¡ˆå¯¹æ¯”

## å¯è§†åŒ–å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ä¼ ç»Ÿæ–¹æ¡ˆ (Current)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  System Prompt (å¸¸é©»)                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ”§ read_file                                                 â”‚   â”‚
â”‚  â”‚    æè¿°: è¯»å–æ–‡ä»¶å†…å®¹ï¼Œæ”¯æŒåˆ†é¡µé¿å… context çˆ†ç‚¸             â”‚   â”‚
â”‚  â”‚    å‚æ•°: path (string), page_size (int), page (int)          â”‚   â”‚
â”‚  â”‚    ç¤ºä¾‹: read_file(path='config.json')                       â”‚   â”‚
â”‚  â”‚    ç¤ºä¾‹: read_file(path='main.py', page_size=50)             â”‚   â”‚
â”‚  â”‚    é”™è¯¯å¤„ç†: æ–‡ä»¶ä¸å­˜åœ¨æ—¶è¿”å›é”™è¯¯ä¿¡æ¯...                       â”‚   â”‚
â”‚  â”‚    [~150 tokens]                                              â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ ğŸ”§ write_file                                                â”‚   â”‚
â”‚  â”‚    æè¿°: å†™å…¥æ–‡ä»¶ï¼Œè‡ªåŠ¨åˆ›å»ºç›®å½•ï¼Œæ”¯æŒè¦†ç›–æˆ–è¿½åŠ ...             â”‚   â”‚
â”‚  â”‚    [~120 tokens]                                              â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ ğŸ”§ edit_file                                                 â”‚   â”‚
â”‚  â”‚    [~100 tokens]                                              â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ ğŸ”§ exec                                                      â”‚   â”‚
â”‚  â”‚    [~80 tokens]                                               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ ğŸ”§ create_tool                                               â”‚   â”‚
â”‚  â”‚    [~200 tokens]                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  æ€»è®¡: ~650 tokens (æ¯æ¬¡å¯¹è¯éƒ½å ç”¨å…¨éƒ¨)                              â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ¸è¿›å¼æŠ«éœ²æ–¹æ¡ˆ (Progressive)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  System Prompt (å¸¸é©»)                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“‹ Skills Index (~300 tokens)                                â”‚   â”‚
â”‚  â”‚    æ–‡ä»¶æ“ä½œ: read_file, write_file, edit_file               â”‚   â”‚
â”‚  â”‚    ç³»ç»Ÿæ“ä½œ: exec                                            â”‚   â”‚
â”‚  â”‚    å·¥å…·ç®¡ç†: create_tool                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚                    â†“ ç”¨æˆ·æŸ¥è¯¢: "è¯»å– config.json"                   â”‚
â”‚                                                                     â”‚
â”‚  Dynamic Injection (æŒ‰éœ€)                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“¥ read_file Full Definition (~150 tokens)                   â”‚   â”‚
â”‚  â”‚    ä»…åœ¨éœ€è¦æ—¶åŠ è½½                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  æœ¬æ¬¡æ€»è®¡: 300 + 150 = 450 tokens                                   â”‚
â”‚  èŠ‚çœ: 200 tokens (30%)                                             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ•°æ®å¯¹æ¯”

### åœºæ™¯ 1: ç®€å•æŸ¥è¯¢
| é¡¹ç›® | ä¼ ç»Ÿæ–¹æ¡ˆ | æ¸è¿›å¼æŠ«éœ² | èŠ‚çœ |
|------|---------|-----------|------|
| æŸ¥è¯¢ | "è¯»å– config.json" | "è¯»å– config.json" | - |
| åŠ è½½ Skills | å…¨éƒ¨ 5 ä¸ª | ä»… read_file | - |
| Token æ¶ˆè€— | 650 | 450 | **30%** |

### åœºæ™¯ 2: å¤æ‚ä»»åŠ¡
| é¡¹ç›® | ä¼ ç»Ÿæ–¹æ¡ˆ | æ¸è¿›å¼æŠ«éœ² | èŠ‚çœ |
|------|---------|-----------|------|
| æŸ¥è¯¢ | "è¯»å– config.jsonï¼Œä¿®æ”¹ç«¯å£ï¼Œä¿å­˜" | åŒå·¦ | - |
| åŠ è½½ Skills | å…¨éƒ¨ 5 ä¸ª | read_file + edit_file + write_file | - |
| Token æ¶ˆè€— | 650 | 300 + 150 + 100 + 120 = 670 | ç•¥å¢ |

### åœºæ™¯ 3: 100 æ¬¡å¯¹è¯
| é¡¹ç›® | ä¼ ç»Ÿæ–¹æ¡ˆ | æ¸è¿›å¼æŠ«éœ² | èŠ‚çœ |
|------|---------|-----------|------|
| æ€» Token | 65,000 | ~45,000 (å¹³å‡) | **31%** |
| æˆæœ¬ (Â¥) | ~1.3 | ~0.9 | Â¥0.4 |

## æ ¸å¿ƒåŒºåˆ«

### ä¼ ç»Ÿæ–¹æ¡ˆçš„é—®é¢˜
1. âŒ **æ— æ³•æ‰©å±•**: skills è¶Šå¤šï¼Œprompt è¶Šé•¿
2. âŒ **æµªè´¹ä¸¥é‡**: å¤§éƒ¨åˆ† skills æ¯æ¬¡å¯¹è¯éƒ½ä¸ä¼šç”¨åˆ°
3. âŒ **cost çº¿æ€§å¢é•¿**: æ¯ 10 ä¸ª skills å¢åŠ  ~1500 tokens

### æ¸è¿›å¼æŠ«éœ²çš„ä¼˜åŠ¿
1. âœ… **å¯æ‰©å±•**: skills æ•°é‡å¯¹ prompt å½±å“å°
2. âœ… **æŒ‰éœ€åŠ è½½**: åªåŠ è½½çœŸæ­£éœ€è¦çš„ skills
3. âœ… **æ™ºèƒ½åŒ¹é…**: è¯­ä¹‰åŒ¹é…æ¯”å…³é”®è¯æ›´å‡†ç¡®
4. âœ… **è‡ªåŠ¨æ¸…ç†**: æ‰§è¡Œåç§»é™¤å®Œæ•´å®šä¹‰
5. âœ… **å­¦ä¹ ä¼˜åŒ–**: å¯ä»¥æ ¹æ®ä½¿ç”¨é¢‘ç‡ä¼˜åŒ–

## å®ç°éš¾åº¦

### ç®€å•ç‰ˆ (1-2 å°æ—¶)
```yaml
# 1. ä¸¤å±‚æ•°æ®ç»“æ„
skills_index:    # å¸¸é©»ï¼Œè½»é‡çº§
  read_file: "è¯»å–æ–‡ä»¶..."
  
skills_full:     # æŒ‰éœ€ï¼Œå®Œæ•´å®šä¹‰
  read_file:
    description: "..."
    parameters: {...}
    examples: [...]

# 2. åŠ¨æ€æ³¨å…¥é€»è¾‘
if need_skill("read_file"):
    inject(skills_full.read_file)
```

### è¿›é˜¶ç‰ˆ (1 å¤©)
```python
# 1. Embedding åŒ¹é…
matcher = SkillsMatcher()
skills = matcher.match(user_query, top_k=2)

# 2. è‡ªåŠ¨æ¸…ç†
after_execution():
    remove_loaded_skills()
    keep_only_summary()
```

### ç”Ÿäº§çº§ (3-5 å¤©)
```python
# 1. å¤šçº§ç¼“å­˜
cache = SkillCache()
cache.l1 = ["å¸¸ç”¨ skills"]      # å¸¸é©»
cache.l2 = ["æœ€è¿‘ä½¿ç”¨"]          # session ç¼“å­˜
cache.l3 = ["å…¨éƒ¨ skills"]       # ç£ç›˜åŠ è½½

# 2. æ™ºèƒ½é¢„åŠ è½½
predict_next_skills(history)

# 3. è‡ªé€‚åº”ä¼˜åŒ–
optimize_by_frequency()
```

## OpenClaw å¯èƒ½çš„æ–¹æ¡ˆ (æ¨æµ‹)

åŸºäº agent æ¡†æ¶çš„å¸¸è§æ¨¡å¼ï¼š

### 1. Tool Registry
```python
class OpenClawToolRegistry:
    def __init__(self):
        self.tools_index = load_index()  # è½»é‡çº§
        self.definitions = {}            # lazy load
    
    def get_tool(self, name):
        if name not in self.definitions:
            self.definitions[name] = load_definition(name)
        return self.definitions[name]
```

### 2. Function Calling API
```yaml
# OpenAI çš„ function calling æœ¬èº«å°±æ˜¯æ¸è¿›å¼æŠ«éœ²
tools:
  - type: function
    function:
      name: "read_file"
      description: "è¯»å–æ–‡ä»¶"  # åªç»™ç®€çŸ­æè¿°
      parameters: {...}        # å®Œæ•´ schema

# API ä¼šè‡ªåŠ¨é€‰æ‹©éœ€è¦çš„å·¥å…·
```

### 3. æ™ºèƒ½è·¯ç”±
```
User Query
    â†“
Intent Classifier (åˆ¤æ–­ç±»å‹)
    â†“
Route to specific Agent (åªåŠ è½½è¯¥ agent çš„ tools)
    â†“
Execute with minimal context
```

## å»ºè®®å®æ–½è·¯å¾„

### Phase 1: ç«‹å³æ”¹è¿› (ä»Šå¤©)
- å°† skills å®šä¹‰ç§»åˆ°å¤–éƒ¨æ–‡ä»¶
- ç³»ç»Ÿæç¤ºè¯åªä¿ç•™ one-liner ç´¢å¼•
- æ‰‹åŠ¨æ ‡æ³¨å“ªäº›ä»»åŠ¡éœ€è¦å“ªäº› skills

### Phase 2: è‡ªåŠ¨åŒ– (æœ¬å‘¨)
- å®ç°å…³é”®è¯è§¦å‘å™¨
- è‡ªåŠ¨æ³¨å…¥å®Œæ•´å®šä¹‰
- æ‰§è¡Œåæ¸…ç† context

### Phase 3: æ™ºèƒ½åŒ– (ä¸‹å‘¨)
- æ·»åŠ  embedding åŒ¹é…
- å®ç°å¤šçº§ç¼“å­˜
- ä¼˜åŒ–ä½¿ç”¨ç»Ÿè®¡

## æ€»ç»“

æ¸è¿›å¼æŠ«éœ²ä¸æ˜¯æ–°æ¦‚å¿µï¼Œä½†åœ¨ Agent skills åœºæ™¯éå¸¸é€‚ç”¨ï¼š

1. **æˆæœ¬å¯æ§**: skills æ‰©å±•ä¸ä¼šçº¿æ€§å¢åŠ  cost
2. **ç”¨æˆ·ä½“éªŒ**: å“åº”æ›´å¿«ï¼Œcontext ç”¨äºæ›´æœ‰ä»·å€¼çš„å†…å®¹
3. **å¯ç»´æŠ¤æ€§**: skills å®šä¹‰ç‹¬ç«‹ï¼Œæ˜“äºæ›´æ–°
4. **å¯æ‰©å±•æ€§**: æ”¯æŒä¸Šç™¾ä¸ª skills è€Œä¸å´©æºƒ

**ç°åœ¨æœ€é‡è¦çš„ä¸€æ­¥**: æŠŠæŠ€èƒ½å®šä¹‰ä»ç³»ç»Ÿæç¤ºè¯ä¸­åˆ†ç¦»å‡ºæ¥ï¼
